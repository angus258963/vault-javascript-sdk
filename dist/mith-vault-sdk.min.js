!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("crypto-js"),require("axios")):"function"==typeof define&&define.amd?define(["crypto-js","axios"],n):(t=t||self).MithVaultSDK=n(t.CryptoJS,t.axios)}(this,function(c,u){"use strict";function i(t,n){for(var e=0;e<n.length;e++){var a=n[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function s(){var e=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function l(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{headers:null,data:null,params:null},a=e.params||e.data||{},i=e.headers||{};if("client_id"in a){var o=function(t,n){var e="";if(t&&Array.isArray(t))e=t.join(",");else if(t){var a=(i=t,Object.keys(i).sort().reduce(function(t,n){return t[n]=i[n],t},{}));e=Object.keys(a).map(function(t){return"".concat(t,"=").concat(a[t])}).join("&")}else t&&(e=t.toString());var i;var o=c.HmacSHA512(e,n);return c.enc.Hex.stringify(o)}(a,c.enc.Hex.parse(this.clientSecert));i["X-Vault-Signature"]=o}var r="".concat(this.api,"/").concat(t);try{return u({method:n,url:r,params:e.params,data:e.data,headers:i}).then(function(t){return t.data}).catch(function(t){throw t})}catch(t){throw t}}function h(){return Math.floor(1e17*Math.random())}return c=c&&c.hasOwnProperty("default")?c.default:c,u=u&&u.hasOwnProperty("default")?u.default:u,function(){function a(t,n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),this.host="https://2019-hackathon.mithvault.io",this.api="https://2019-hackathon.api.mithvault.io",this.authorize="/#/oauth/authorize",this.donate="/#/donate",this.clientId=t,this.clientSecert=n,this.miningKey=e}var t,n,e;return t=a,(n=[{key:"getBindURI",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n={client_id:this.clientId,state:t||s()},e=Object.keys(n).map(function(t){return"".concat(t,"=").concat(n[t])}).join("&");return"".concat(this.host).concat(this.authorize,"?").concat(e)}},{key:"getDonateURI",value:function(t,n,e,a,i){var o={app_id:t,user_id:n,amount:e,state:a,desc:i},r=Object.keys(o).map(function(t){return"".concat(t,"=").concat(o[t])}).join("&");return"".concat(this.host).concat(this.donate,"?").concat(r)}},{key:"getAccessToken",value:function(t,n){var e={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h(),grant_code:t,state:n};return l.call(this,"oauth/token","POST",{data:e})}},{key:"delUnbindToken",value:function(t){var n={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h()};return l.call(this,"oauth/token","DELETE",{headers:{Authorization:t},params:n})}},{key:"getClientInformation",value:function(){var t={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h()};return l.call(this,"oauth/balance","GET",{params:t})}},{key:"getUserInformation",value:function(t){var n={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h()};return l.call(this,"oauth/user-info","GET",{headers:{Authorization:t},params:n})}},{key:"getUserMiningAction",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h(),mining_key:this.miningKey},a={Authorization:t};return n&&(e.next_id=n),l.call(this,"mining","GET",{headers:a,params:e})}},{key:"postUserMiningAction",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=new Date,o=function(t){return t.toString().padStart(2,0)},r={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h(),mining_key:this.miningKey,uuid:n||s(),reward:e,happened_at:a||"".concat(i.getUTCFullYear(),"-").concat(o(i.getUTCMonth()),"-").concat(o(i.getUTCDate()),"T").concat(o(i.getUTCHours()),":").concat(o(i.getUTCMinutes()),":").concat(o(i.getUTCSeconds()))};return l.call(this,"mining","POST",{headers:{Authorization:t},data:r})}},{key:"deleteUserMiningAction",value:function(t,n){var e={client_id:this.clientId,timestamp:Math.floor(Date.now()/1e3),nonce:h(),mining_key:this.miningKey,uuid:n||s()};return l.call(this,"mining","DELETE",{headers:{Authorization:t},params:e})}}])&&i(t.prototype,n),e&&i(t,e),a}()});
